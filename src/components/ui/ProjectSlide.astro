---
import type { Project } from "../../content/projects";
const { project } = Astro.props as { project: Project };
---

<article class="swSlide" data-sw-slide>
  <div class="swSlide__inner">
    <!-- Título con brackets -->
    <div class="swTitle" data-sw-title>
      <span class="swBracket swBracket--left" aria-hidden="true">[</span>
      <h3 class="swTitle__text">{project.title}</h3>
      <span class="swBracket swBracket--right" aria-hidden="true">]</span>
    </div>

    <!-- Contenido (aparece “al abrirse”) -->
    <div class="swReveal" data-sw-reveal>
      <div class="swImageWrap">
        <img
          class="swImage"
          src={project.image.src}
          alt={project.image.alt}
          loading="lazy"
          decoding="async"
        />
      </div>

      <div class="swMeta">
        <span class="swMeta__left">{project.category}</span>
        <span class="swMeta__right">{project.year}</span>
      </div>

      <!-- <div class="swCtaRow">
        <a class="swCta" href={`/work/${project.slug}`}>Discover +</a>
      </div> -->
    </div>
  </div>
</article>

<style>
  /* Cada proyecto = 100vh */
  .swSlide {
    height: 100vh;
    position: relative;
    display: grid;
    place-items: center;
    overflow: hidden;

    /* Compensa el header sticky (para que el título no quede tapado) */
    padding-top: calc(var(--sw-header-h, 56px) + 2vh);
    padding-bottom: 4vh;
  }

  .swSlide__inner {
    width: min(1100px, calc(100vw - 32px));
    margin: 0 auto;

    height: calc(100vh - var(--sw-header-h, 56px) - 6vh);
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    text-align: center;
  }

  /* Título gigante */
  .swTitle {
    display: grid;
    grid-template-columns: auto 1fr auto;
    align-items: baseline;
    gap: clamp(8px, 1.2vw, 14px);
    transform: none; /* important: NO lo saques del viewport */
    margin-top: 0;
  }

  .swTitle__text {
    font-size: clamp(52px, 7vw, 112px);
    line-height: .92;
    letter-spacing: -0.02em;
    font-weight: 600;
    margin: 0;
    white-space: nowrap;
    font-family: ui-sans-serif, system-ui, -apple-system, "Helvetica Neue", Arial, sans-serif;
  }

  /* Brackets “viajan” hacia afuera con scroll */
  .swBracket {
    font-size: clamp(56px, 7.2vw, 120px);
    line-height: 1;
    transform: translateX(0);
    will-change: transform, opacity;
  }

  /* Reveal (imagen + meta) inicialmente cerrado */
  .swReveal {
    opacity: 0;
    transform: translateY(12px);
    transition: opacity 380ms ease, transform 520ms cubic-bezier(0.22, 1, 0.36, 1);
    pointer-events: none;

    /* ocupa el centro del layout */
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: center;
  }

  .swImageWrap {
    /* width: min(640px, 58vw); */
    margin: 2% auto;
    background: #f2f2f2;
    overflow: hidden;
  }

  .swImage {
    display: block;
    width: 100%;
    height: auto;
    transform: scale(1.02);
  }

  .swMeta {
    display: flex;
    justify-content: space-between;
    align-items: center;

    width: 100%;
    max-width: 1100px;
    margin: 24px auto 0;

    /* padding: 0 24px; */
  }

  .swMeta__left { 
    text-transform: none; 
    font-family: ui-sans-serif, system-ui, -apple-system, "Helvetica Neue", Arial, sans-serif;
  }
  .swMeta__right { 
    text-transform: none; 
    font-family: ui-sans-serif, system-ui, -apple-system, "Helvetica Neue", Arial, sans-serif;
  }

  .swCtaRow {
    margin-top: 14px;
    display: flex;
    justify-content: center;
  }

  .swCta {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    font-size: 12px;
    letter-spacing: .08em;
    text-transform: uppercase;
    padding: 10px 14px;
    border-radius: 999px;
    border: 1px solid rgba(11,11,12,.18);
    text-decoration: none;
    color: inherit;
    background: rgba(255,255,255,.85);
    backdrop-filter: blur(10px);
  }

  /* Estados controlados por JS */
  .swSlide.is-active .swReveal {
    opacity: 1;
    transform: translateY(0);
    pointer-events: auto;
  }

  @media (prefers-reduced-motion: reduce) {
    .swReveal { opacity: 1; transform: none; transition: none; }
    .swTitle { transform: none; }
    .swBracket { transform: none !important; }
  }
</style>