---
// Eliminamos la importación con ?url que causaba el error de MIME type en Cloudflare
const VIDEO_URL = "https://assets.jeronimonunez.com/video/backgroundHero.mp4";
---

<section class="hero" data-hero aria-label="Hero">
  <div class="sticky" data-sticky>
    <div class="stage" data-stage>
      <div class="universe" data-universe>
        <div class="grid isUniverse" data-grid aria-hidden="true">
          <div class="cell cell--r1a cell--plate"></div>
          <div class="cell cell--r1b cell--plate"></div>

          <div class="cell cell--r2a cell--plate"></div>

          <div class="cell cell--videoSlot" data-video-slot>
            <div class="videoWrap" data-video-wrap>
              <video
                data-video
                class="bgVideo"
                muted
                playsinline
                webkit-playsinline
                preload="metadata"
                crossorigin="anonymous"
              >
                <source src={VIDEO_URL} type="video/mp4" />
              </video>

              <div class="overlay" data-overlay aria-hidden="true"></div>

              <div class="videoAct3" data-act3-inside>
                <div class="act3Inner" data-act="3">
                  <h2 class="title">
                    Crecimiento sólido,<br />desde la base.
                  </h2>
                  <p class="subtitle">
                    Arquitectura preparada para escalar con coherencia y seguridad real.
                  </p>
                </div>
              </div>
            </div>
          </div>

          <div class="cell cell--r2c cell--plate"></div>

          <div class="cell cell--r3a cell--plate"></div>
          <div class="cell cell--r3b cell--plate"></div>
        </div>
      </div>

      <div class="copy" data-copy>
        <div class="act act--1 isActive" data-act="1">
          <p class="eyebrow">UX/UI | Arquitectura Frontend | Security-by-Design</p>
          <h1 class="title">
            Arquitectura frontend,<br />orientada a producto.
          </h1>
          <p class="subtitle">
            Sistemas escalables, con contratos claros y foco en resiliencia y seguridad.
          </p>

          <div class="actions" data-actions>
            <a class="btn btn--primary" href="#destacados">Ver Proyectos</a>
            <a class="btn btn--ghost" href="#contact">Contactar</a>
          </div>
        </div>

        <div class="act act--2" data-act="2">
          <h2 class="title">
            Cada interfaz es parte<br />de un sistema mayor.
          </h2>
          <p class="subtitle">
            Arquitectura por dominio, estructurado para escalar con seguridad y límites bien definidos.
          </p>
        </div>
      </div>
    </div>
  </div>
</section>

<script>
  import "./heroVertical.client.ts";
</script>

<style>
/* =========================
   MOBILE FIRST (base)
   ========================= */

.hero {
  height: 520vh;
  position: relative;
  overflow: clip;
  background: #fafafa;
  color: #fff;
}

.sticky {
  position: sticky;
  top: 0;
  height: 100vh;
  overflow: hidden;
  background: #fafafa;
}

.stage {
  position: relative;
  width: 100%;
  height: 100%;
}

/* UNIVERSE wrapper */
.universe {
  position: absolute;
  inset: 0;
  z-index: 1;
  transform-origin: 50% 50%;
  will-change: transform;
}

/* GRID base (mobile) */
.grid.isUniverse {
  position: absolute;
  inset: 0;
  padding: 14px;

  --gap: 10px;
  --r: 12px;

  display: grid;
  gap: var(--gap);
  pointer-events: none;

  /* mobile layout: 1 col */
  grid-template-columns: 1fr;
  grid-template-rows: 1.15fr 0.6fr 0.6fr 0.6fr;
}

/* Base cell (NO colores acá para no pisar) */
.grid.isUniverse .cell {
  border-radius: 4px;
  overflow: hidden;
  border: 1px solid #eaeaea;
  background: transparent;
}

/* PLATES */
.grid.isUniverse .cell--plate {
  background: #fff;
  border-color: #eaeaea;
  box-shadow:
  0 1px 0 rgba(0,0,0,0.02),
  0 10px 30px rgba(0,0,0,0.04);
}

.grid.isUniverse .cell--plate.cell--muted {
  background: #fff;
}

/* VIDEO SLOT */
.grid.isUniverse .cell--videoSlot {
  position: relative;
  background: #fff;
  border-color: #eaeaea;
}

.videoWrap {
  position: absolute;
  inset: 0;
  overflow: hidden;
  border-radius: 4px;
}

.bgVideo {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  object-fit: cover;
  transform: translateZ(0);
}

.overlay {
  position: absolute;
  inset: 0;
  opacity: 0.55;
  background:
    radial-gradient(1200px 600px at 25% 30%, rgba(0,0,0,0.18), rgba(0,0,0,0.78)),
    linear-gradient(to bottom, rgba(0,0,0,0.25), rgba(0,0,0,0.78));
  will-change: opacity;
}

/* Mobile ordering */
.cell--videoSlot { grid-column: 1; grid-row: 1; min-height: 46vh; }
.cell--r1a       { grid-column: 1; grid-row: 2; min-height: 14vh; }
.cell--r1b       { grid-column: 1; grid-row: 3; min-height: 14vh; }
.cell--r3a       { grid-column: 1; grid-row: 4; min-height: 14vh; }

/* Hide extras on mobile */
.cell--r2a,
.cell--r2c,
.cell--r3b {
  display: none;
}

/* COPY */
.copy {
  position: relative;
  z-index: 3;
  width: calc(100% - 2rem);
  margin: 0 auto;
  height: 100%;
  display: grid;
  align-content: center;
  padding-top: 12vh;
  pointer-events: auto;
  font-family: ui-sans-serif, system-ui, -apple-system, "Helvetica Neue", Arial, sans-serif;
}

.act {
  position: absolute;
  inset: 0;
  display: grid;
  align-content: center;
  opacity: 0;
  transform: translateY(18px);
  transition: opacity 0.6s ease, transform 0.6s ease;
  pointer-events: none;
}

.act.isActive {
  opacity: 1;
  transform: translateY(0);
  pointer-events: auto;
}

.eyebrow {
  letter-spacing: 0.08em;
  text-transform: uppercase;
  font-size: 0.8rem;
  opacity: 0.85;
  margin: 0 0 0.75rem;
}

.title {
  font-size: clamp(2.0rem, 7vw, 3.2rem);
  line-height: 1.02;
  margin: 0 0 1rem;
  max-width: 22ch;
}

.subtitle {
  font-size: clamp(1rem, 3.5vw, 1.15rem);
  line-height: 1.55;
  opacity: 0.9;
  max-width: 60ch;
  margin: 0 0 1.5rem;
}

.actions {
  display: flex;
  gap: 0.75rem;
  flex-wrap: wrap;
  margin-top: 1.25rem;
}

.btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  height: 44px;
  padding: 0 1.05rem;
  border-radius: 999px;
  font-weight: 600;
  text-decoration: none;
  border: 1px solid rgba(255,255,255,0.18);
  backdrop-filter: blur(10px);
}

.btn--primary {
  background: rgba(255,255,255,0.92);
  color: #0a0a0a;
  border-color: rgba(255,255,255,0.35);
}

.btn--ghost {
  background: rgba(0,0,0,0.18);
  color: #fff;
}

/* ACT 3 inside video */
.videoAct3 {
  position: absolute;
  inset: 0;
  z-index: 4;
  pointer-events: none;
  display: grid;
  align-content: center;
  padding: 18px;
  opacity: 0;
  transform: translate3d(0, 12px, 0);
  will-change: opacity, transform;
}

.videoAct3 .title {
  font-size: clamp(1.4rem, 5vw, 2.2rem);
  line-height: 1.05;
  margin: 0 0 0.8rem;
  max-width: 22ch;
}

.videoAct3 .subtitle {
  font-size: clamp(0.95rem, 3.2vw, 1.05rem);
  line-height: 1.55;
  margin: 0;
  max-width: 60ch;
}

/* Viewport moderno (Safari iOS / Chrome mobile) */
.sticky{
  height: 100svh;
}

/* Fallback si svh no existe */
@supports not (height: 100svh){
  .sticky{ height: 100vh; }
}


/* =========================
   DESKTOP (single breakpoint)
   ========================= */
@media (min-width: 920px) {
  .grid.isUniverse {
    top: -6vh;
    left: -2vw;
    right: -2vw;
    height: 128vh;
    padding: clamp(10px, 1.2vw, 18px);

    grid-template-columns: 1fr 2fr 1fr;
    grid-template-rows: 0.78fr 1fr 1fr;
  }

  /* Show all cells */
  .cell--r2a,
  .cell--r2c,
  .cell--r3b {
    display: block;
  }

  /* Desktop placement */
  .cell--r1a { grid-column: 1 / 2; grid-row: 1 / 2; }
  .cell--r1b { grid-column: 2 / 4; grid-row: 1 / 2; }
  .cell--r2a { grid-column: 1 / 2; grid-row: 2 / 3; }
  .cell--videoSlot { grid-column: 2 / 3; grid-row: 2 / 3; min-height: auto; }
  .cell--r2c { grid-column: 3 / 4; grid-row: 2 / 3; }
  .cell--r3a { grid-column: 1 / 3; grid-row: 3 / 4; }
  .cell--r3b { grid-column: 3 / 4; grid-row: 3 / 4; }

  .copy {
    width: min(1120px, calc(100% - 3rem));
    padding-top: 6vh;
  }

  .title {
    font-size: clamp(2.2rem, 4.6vw, 4.2rem);
  }

  .subtitle {
    font-size: clamp(1.05rem, 1.2vw, 1.2rem);
    max-width: 72ch;
  }

  .videoAct3 {
    padding: clamp(14px, 2.4vw, 38px);
  }

  .videoAct3 .title {
    font-size: clamp(1.6rem, 3.2vw, 3.2rem);
  }

  .videoAct3 .subtitle {
    font-size: clamp(0.95rem, 1.15vw, 1.15rem);
  }
}

@media (prefers-reduced-motion: reduce) {
  .universe { transform: none !important; }
  .grid { transform: none !important; }
  .videoWrap { transform: none !important; }
}

@media (max-width: 520px){
  .copy{
    width: calc(100% - 1.5rem);
    padding-top: 10svh;
  }

  .title{
    font-size: clamp(1.9rem, 9vw, 2.6rem);
    max-width: 18ch;
  }

  .subtitle{
    font-size: 1rem;
    max-width: 44ch;
  }

  .actions{
    gap: .6rem;
  }

  .btn{
    height: 42px;
    padding: 0 .95rem;
  }
}

</style>